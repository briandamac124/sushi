window.Namespace=function(){var a=this;a.global={};a.updateGlobal=function(b,e){e=!!e;for(var c in b)if(Object.hasOwnProperty.call(b,c)){var d=b[c];if(e&&void 0!==a.global[c])throw"Already defined: "+c+" => "+a.global[c];a.global[c]=d}};a.get=function(b,a){var c=b.split("."),d=this;try{for(var f=0;f<c.length;f++)if(d=d[c[f]],void 0===d)return a;return d}catch(g){return a}};a.exists=function(b){return void 0!==a.get(b,void 0)};a.require=function(b){var e=a.get(b,void 0);if(void 0===e)throw"required value ('"+
b+"') not defined";return e};a.define=function(b,e,c){var d=b.split("."),f=d.pop();c=c||[];c.unshift(a);for(var g=this,h=0;h<d.length;h++)var k=d[h],g=g[k]=g[k]||{};if(g[f])throw"Cannot define '"+b+"' (already exists)";b=g[f]={};e.apply(b,c)}};window.Locu=new window.Namespace;

Date.prototype.toISOString||function(){function a(a){a=String(a);1===a.length&&(a="0"+a);return a}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1E3).toFixed(3)).slice(2,5)+"Z"}}();"object"!==typeof JSON&&(JSON={});
(function(){function a(a){return 10>a?"0"+a:a}function h(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var e=p[a];return"string"===typeof e?e:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function k(a,d){var e,f,l,r,t=b,g,c=d[a];c&&"object"===typeof c&&"function"===typeof c.toJSON&&(c=c.toJSON(a));"function"===typeof m&&(c=m.call(d,a,c));switch(typeof c){case "string":return h(c);case "number":return isFinite(c)?String(c):"null";case "boolean":case "null":return String(c);
case "object":if(!c)return"null";b+=q;g=[];if("[object Array]"===Object.prototype.toString.apply(c)){r=c.length;for(e=0;e<r;e+=1)g[e]=k(e,c)||"null";l=0===g.length?"[]":b?"[\n"+b+g.join(",\n"+b)+"\n"+t+"]":"["+g.join(",")+"]";b=t;return l}if(m&&"object"===typeof m)for(r=m.length,e=0;e<r;e+=1)"string"===typeof m[e]&&(f=m[e],(l=k(f,c))&&g.push(h(f)+(b?": ":":")+l));else for(f in c)Object.prototype.hasOwnProperty.call(c,f)&&(l=k(f,c))&&g.push(h(f)+(b?": ":":")+l);l=0===g.length?"{}":b?"{\n"+b+g.join(",\n"+
b)+"\n"+t+"}":"{"+g.join(",")+"}";b=t;return l}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var n=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,b,q,p={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},m;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,d,e){var f;q=b="";if("number"===typeof e)for(f=0;f<e;f+=1)q+=" ";else"string"===typeof e&&(q=e);if((m=d)&&"function"!==typeof d&&("object"!==typeof d||"number"!==typeof d.length))throw Error("JSON.stringify");return k("",{"":a})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,d){function e(a,b){var f,g,c=a[b];if(c&&"object"===typeof c)for(f in c)Object.prototype.hasOwnProperty.call(c,f)&&(g=e(c,f),void 0!==g?c[f]=g:delete c[f]);return d.call(a,b,c)}var b;a=String(a);n.lastIndex=0;n.test(a)&&(a=a.replace(n,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return b=eval("("+a+")"),"function"===typeof d?e({"":b},""):b;throw new SyntaxError("JSON.parse");})})();
Locu.define("Identity",function(){var a=this,h,k;a.update=function(){h=!1;k=[];n()};var n=function(){if(!h){var d,b=window.Locu.global.locuDomain||"";d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");d.onreadystatechange=function(){if(4==d.readyState)if(200==d.status){var b=JSON.parse(d.responseText),p;for(p in b)a[p]=b[p];for(h=!0;b=k.shift();)b.call()}else 5>=++a.retry&&n()};d.open("GET",b+"/identity/",!0);""!=b&&window.XMLHttpRequest&&(d.withCredentials=!0);d.send()}};
a.ready=function(a){h?a.call():k.push(a)};a.update()});
